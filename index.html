<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle Profissional de Vendas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<style>
:root{
  --bg:#0b1020;
  --sidebar:#0a0f1e;
  --card:#111827;
  --primary:#6366f1;
  --green:#22c55e;
  --red:#ef4444;
  --text:#e5e7eb;
  --muted:#9ca3af;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:linear-gradient(135deg,#0b1020,#0f172a);
  color:var(--text)
}
.layout{
  display:grid;
  grid-template-columns:260px 1fr;
  min-height:100vh
}

/* MENU LATERAL */
aside{
  background:linear-gradient(180deg,#020617,#0a0f1e);
  padding:22px
}
aside h2{
  color:var(--primary);
  margin-bottom:25px;
  letter-spacing:1px
}
aside button{
  width:100%;
  background:transparent;
  color:#c7d2fe;
  border:none;
  padding:14px 16px;
  border-radius:14px;
  margin-bottom:10px;
  text-align:left;
  cursor:pointer;
  font-size:15px;
  transition:.25s
}
aside button:hover{
  background:#1f2937;
  transform:translateX(6px)
}
aside button.active{
  background:var(--primary);
  color:white;
  box-shadow:0 12px 30px rgba(99,102,241,.45)
}

main{padding:26px}
.section{display:none}
.section.active{display:block}

/* PAINEL */
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(230px,1fr));
  gap:18px
}
.card{
  background:linear-gradient(180deg,#111827,#020617);
  padding:22px;
  border-radius:22px;
  box-shadow:0 20px 50px rgba(0,0,0,.45)
}
.card h4{
  font-weight:500;
  color:var(--muted);
  margin-bottom:10px
}
.valor{
  font-size:28px;
  font-weight:700
}
.green{color:var(--green)}
.red{color:var(--red)}

.grafico-box{
  margin-top:25px;
  background:linear-gradient(180deg,#0f172a,#020617);
  padding:25px;
  border-radius:26px;
  box-shadow:0 25px 60px rgba(0,0,0,.55)
}

/* FORM */
input,select{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  margin-top:12px;
  background:#020617;
  color:white
}
button.primary{
  margin-top:14px;
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  background:var(--primary);
  color:white;
  font-size:15px;
  cursor:pointer
}

/* HIST√ìRICO */
table{
  width:100%;
  border-collapse:collapse
}
th,td{
  padding:12px;
  border-bottom:1px solid #1f2937;
  vertical-align:top
}
.item-chip{
  background:#1f2937;
  padding:6px 10px;
  border-radius:8px;
  font-size:13px;
  margin:3px 0
}

/* MOBILE */
@media(max-width:900px){
  .layout{grid-template-columns:1fr}
  aside{display:flex;gap:10px;overflow:auto}
}
</style>
</head>

<body>
<div class="layout">

<aside>
  <h2>Vendas</h2>
  <button class="active" onclick="show('painel',this)">üìä Painel</button>
  <button onclick="show('meta',this)">üéØ Meta do m√™s</button>
  <button onclick="show('vendas',this)">‚ûï Nova venda</button>
  <button onclick="show('historico',this)">üìÅ Hist√≥rico</button>
</aside>

<main>

<!-- PAINEL -->
<section id="painel" class="section active">
  <div class="cards">
    <div class="card">
      <h4>M√™s ativo</h4>
      <div id="mesTexto" class="valor"></div>
    </div>
    <div class="card">
      <h4>Meta do m√™s</h4>
      <div id="metaValor" class="valor"></div>
    </div>
    <div class="card">
      <h4>Total vendido</h4>
      <div id="totalVendido" class="valor"></div>
    </div>
    <div class="card">
      <h4>Comiss√£o</h4>
      <div id="totalComissao" class="valor green"></div>
    </div>
    <div class="card">
      <h4>Falta para meta</h4>
      <div id="faltaMeta" class="valor red"></div>
    </div>
  </div>

  <div class="grafico-box">
    <h3>Vendas da semana</h3>
    <div id="graficoSemanal"></div>
  </div>
</section>

<!-- META -->
<section id="meta" class="section">
  <div class="card">
    <h3>Configurar meta mensal</h3>
    <select id="mesAtivo"></select>
    <input id="metaMes" placeholder="Meta do m√™s">
    <button class="primary" onclick="salvarMeta()">Salvar meta</button>
  </div>
</section>

<!-- VENDAS -->
<section id="vendas" class="section">
  <div class="card">
    <h3>Nova venda</h3>
    <input id="valorVenda" placeholder="Valor total da venda">
    <select id="percentual">
      <option>6</option><option>5</option><option>4</option><option>3</option>
    </select>
    <input id="clienteVenda" placeholder="Nome do cliente">
    <button class="primary" onclick="salvarVenda()">Salvar venda</button>
  </div>
</section>

<!-- HIST√ìRICO -->
<section id="historico" class="section">
  <div class="card">
    <h3>Hist√≥rico do m√™s</h3>
    <table>
      <thead>
        <tr><th>Data</th><th>Cliente</th><th>Valor</th></tr>
      </thead>
      <tbody id="listaVendas"></tbody>
    </table>
  </div>
</section>

</main>
</div>

<script>
const meses=["Janeiro","Fevereiro","Mar√ßo","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"];
function moeda(v){return v.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}
function num(v){return Number(v.replace(/\./g,"").replace(",","."))}

let dados=JSON.parse(localStorage.getItem("controleVendas"))||{mesAtivo:"",meses:{}};

function show(id,btn){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  document.querySelectorAll("aside button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");
}

function init(){
  let d=new Date();
  let m=d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0");
  if(!dados.mesAtivo)dados.mesAtivo=m;
  if(!dados.meses[m])dados.meses[m]={meta:0,vendas:[]};
  renderMeses();
  atualizar();
}

function renderMeses(){
  mesAtivo.innerHTML="";
  for(let i=0;i<12;i++){
    let m=new Date().getFullYear()+"-"+String(i+1).padStart(2,"0");
    mesAtivo.innerHTML+=`<option value="${m}">${meses[i]}</option>`;
  }
  mesAtivo.value=dados.mesAtivo;
  metaMes.value=dados.meses[dados.mesAtivo].meta||"";
}

function salvarMeta(){
  let m=mesAtivo.value;
  dados.mesAtivo=m;
  dados.meses[m]=dados.meses[m]||{meta:0,vendas:[]};
  dados.meses[m].meta=num(metaMes.value||"0");
  salvar();
}

function salvarVenda(){
  let m=dados.mesAtivo;
  let valor=num(valorVenda.value||"0");
  if(valor<=0)return;
  let perc=Number(percentual.value);
  dados.meses[m].vendas.push({
    valor,
    cliente:clienteVenda.value,
    com:valor*perc/100,
    data:new Date()
  });
  valorVenda.value="";clienteVenda.value="";
  salvar();
}

function salvar(){
  localStorage.setItem("controleVendas",JSON.stringify(dados));
  atualizar();
}

let grafico;
function atualizar(){
  let m=dados.mesAtivo;
  let mes=dados.meses[m];
  let total=mes.vendas.reduce((a,b)=>a+b.valor,0);
  let com=mes.vendas.reduce((a,b)=>a+b.com,0);

  mesTexto.innerText=meses[Number(m.split("-")[1])-1];
  metaValor.innerText=moeda(mes.meta);
  totalVendido.innerText=moeda(total);
  totalComissao.innerText=moeda(com);
  faltaMeta.innerText=moeda(Math.max(mes.meta-total,0));

  listaVendas.innerHTML="";
  mes.vendas.forEach(v=>{
    listaVendas.innerHTML+=`
    <tr>
      <td>${v.data.toLocaleDateString("pt-BR")}</td>
      <td>${v.cliente}</td>
      <td>${moeda(v.valor)}</td>
    </tr>`;
  });

  let semana=[0,0,0,0,0,0,0];
  mes.vendas.forEach(v=>{
    semana[v.data.getDay()]+=v.valor;
  });

  if(grafico)grafico.destroy();
  grafico=new ApexCharts(document.querySelector("#graficoSemanal"),{
    chart:{type:"area",height:300,toolbar:{show:false}},
    series:[{name:"Vendas",data:semana}],
    xaxis:{categories:["Dom","Seg","Ter","Qua","Qui","Sex","S√°b"]},
    colors:["#6366f1"],
    stroke:{curve:"smooth",width:3},
    fill:{type:"gradient",gradient:{opacityFrom:.6,opacityTo:.05}}
  });
  grafico.render();
}

init();
</script>
</body>
</html>
