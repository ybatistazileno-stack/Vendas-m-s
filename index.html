<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard Corporativo de Vendas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- ApexCharts -->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>

<style>
:root{
  --bg:#0b1020;
  --sidebar-bg:rgba(15,23,42,.75);
  --glass:rgba(255,255,255,.06);
  --neon:#6366f1;
  --neon-soft:#818cf8;
  --green:#22c55e;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:radial-gradient(circle at top,#141b3a,#0b1020);
  color:var(--text);
}

/* LAYOUT */
.layout{
  display:grid;
  grid-template-columns:90px 1fr;
  min-height:100vh;
}

/* SIDEBAR */
aside{
  background:linear-gradient(180deg,#0f172a,#020617);
  backdrop-filter:blur(12px);
  border-right:1px solid rgba(255,255,255,.08);
  padding:20px 10px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:12px;
}

aside .logo{
  width:48px;
  height:48px;
  border-radius:14px;
  background:linear-gradient(135deg,var(--neon),#9333ea);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:bold;
  margin-bottom:10px;
}

.nav-btn{
  width:54px;
  height:54px;
  border-radius:16px;
  background:var(--glass);
  border:1px solid rgba(255,255,255,.08);
  color:var(--text);
  font-size:20px;
  cursor:pointer;
  transition:.3s;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}

.nav-btn:hover{
  background:rgba(99,102,241,.25);
  box-shadow:0 0 18px rgba(99,102,241,.6);
}

.nav-btn.active{
  background:linear-gradient(135deg,var(--neon),var(--neon-soft));
  box-shadow:0 0 20px rgba(99,102,241,.8);
}

.nav-btn span{
  position:absolute;
  left:70px;
  white-space:nowrap;
  background:#020617;
  padding:6px 10px;
  border-radius:8px;
  opacity:0;
  pointer-events:none;
  transition:.2s;
  font-size:13px;
}

.nav-btn:hover span{opacity:1}

/* MAIN */
main{
  padding:25px;
}

/* SE√á√ïES */
.section{display:none}
.section.active{display:block}

/* CARDS */
.cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
}

.card{
  background:linear-gradient(145deg,#111827,#020617);
  border:1px solid rgba(255,255,255,.08);
  border-radius:18px;
  padding:20px;
}

.valor{
  font-size:26px;
  font-weight:bold;
}

.green{color:var(--green)}

/* PROGRESS */
.progress{
  background:#1f2937;
  border-radius:10px;
  height:14px;
  overflow:hidden;
}
.progress div{
  height:100%;
  background:linear-gradient(90deg,var(--neon),var(--green));
  width:0%;
}

/* FORM */
input,select,button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  margin-top:10px;
  background:#020617;
  color:white;
  border:1px solid rgba(255,255,255,.08);
}

button.primary{
  background:linear-gradient(135deg,var(--neon),var(--neon-soft));
  cursor:pointer;
}

button.primary:hover{
  box-shadow:0 0 20px rgba(99,102,241,.8);
}

/* TABLE */
table{
  width:100%;
  border-collapse:collapse;
}
th,td{
  padding:10px;
  border-bottom:1px solid #1f2937;
  text-align:center;
}
td button{
  padding:6px 10px;
  border-radius:8px;
  border:none;
  cursor:pointer;
  background:var(--glass);
  color:white;
}

@media(max-width:900px){
  .layout{grid-template-columns:1fr}
  aside{
    flex-direction:row;
    height:80px;
    width:100%;
    border-right:none;
    border-bottom:1px solid rgba(255,255,255,.08);
  }
  aside .logo{display:none}
  .nav-btn span{display:none}
}
</style>
</head>

<body>
<div class="layout">

<!-- SIDEBAR -->
<aside>
  <div class="logo">V</div>

  <button class="nav-btn active" onclick="show('painel',this)">üè†<span>Painel</span></button>
  <button class="nav-btn" onclick="show('planejamento',this)">üéØ<span>Meta do m√™s</span></button>
  <button class="nav-btn" onclick="show('vendas',this)">‚ûï<span>Nova venda</span></button>
  <button class="nav-btn" onclick="show('historico',this)">üìÅ<span>Hist√≥rico</span></button>
  <button class="nav-btn" onclick="show('relatorio',this)">üìÜ<span>Relat√≥rios</span></button>
</aside>

<main>

<!-- PAINEL -->
<section id="painel" class="section active">
  <div class="cards">
    <div class="card">
      <h4>Meta do m√™s</h4>
      <div id="metaValor" class="valor">R$ 0,00</div>
      <div class="progress"><div id="barraMeta"></div></div>
      <small id="percentualMeta">0%</small>
    </div>

    <div class="card"><h4>Total vendido</h4><div id="totalVendido" class="valor">R$ 0,00</div></div>
    <div class="card"><h4>Falta para meta</h4><div id="faltaMeta" class="valor">R$ 0,00</div></div>
    <div class="card"><h4>Comiss√£o</h4><div id="totalComissao" class="valor green">R$ 0,00</div></div>
  </div>

  <div class="card" style="margin-top:20px">
    <h3>Vendas ‚Äì Evolu√ß√£o</h3>
    <div id="graficoPrincipal"></div>
  </div>
</section>

<!-- PLANEJAMENTO -->
<section id="planejamento" class="section">
  <div class="card">
    <h3>Definir meta do m√™s</h3>
    <input id="metaInput" placeholder="Ex: 15.000,00">
    <button class="primary" onclick="salvarMeta()">Salvar meta</button>
  </div>
</section>

<!-- VENDAS -->
<section id="vendas" class="section">
  <div class="card">
    <h3>Nova venda</h3>
    <input id="vendaInput" placeholder="Ex: 2.090,00">
    <select id="percentual">
      <option value="6">6%</option>
      <option value="5">5%</option>
      <option value="4">4%</option>
      <option value="3">3%</option>
    </select>
    <button class="primary" onclick="adicionarVenda()">Adicionar venda</button>
  </div>
</section>

<!-- HIST√ìRICO -->
<section id="historico" class="section">
  <div class="card">
    <h3>Hist√≥rico de vendas</h3>
    <table>
      <thead>
        <tr><th>Data</th><th>Valor</th><th>%</th><th>Comiss√£o</th></tr>
      </thead>
      <tbody id="listaVendas"></tbody>
    </table>
  </div>
</section>

<!-- RELAT√ìRIO -->
<section id="relatorio" class="section">
  <div class="card">
    <h3>Relat√≥rio mensal</h3>
    <table>
      <thead><tr><th>M√™s</th><th>Total</th></tr></thead>
      <tbody id="relatorioAnual"></tbody>
    </table>
  </div>
</section>

</main>
</div>

<script>
function num(v){return Number(v.replace(/\./g,"").replace(",","."))}
function moeda(v){return v.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}

let dados = JSON.parse(localStorage.getItem("controleVendas")) || {
  meta:0,
  vendas:[]
};

function show(id,btn){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll(".nav-btn").forEach(b=>b.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  if(btn)btn.classList.add("active");
}

function salvar(){
  localStorage.setItem("controleVendas",JSON.stringify(dados));
  atualizarTudo();
}

function salvarMeta(){
  dados.meta=num(metaInput.value||"0");
  salvar();
}

function adicionarVenda(){
  let valor=num(vendaInput.value);
  if(valor<=0)return;
  let p=Number(percentual.value);
  dados.vendas.push({valor,perc:p,com:valor*p/100,data:new Date()});
  vendaInput.value="";
  salvar();
}

let grafico;
function atualizarTudo(){
  let meses={};
  dados.vendas.forEach(v=>{
    let k=v.data.getFullYear()+"-"+String(v.data.getMonth()+1).padStart(2,"0");
    meses[k]=(meses[k]||0)+v.valor;
  });

  let labels=Object.keys(meses).sort();
  let valores=labels.map(l=>meses[l]);

  let total=valores.reduce((a,b)=>a+b,0);
  let com=dados.vendas.reduce((a,b)=>a+b.com,0);

  metaValor.innerText=moeda(dados.meta);
  totalVendido.innerText=moeda(total);
  faltaMeta.innerText=moeda(Math.max(dados.meta-total,0));
  totalComissao.innerText=moeda(com);

  let perc=dados.meta>0?(total/dados.meta)*100:0;
  barraMeta.style.width=Math.min(perc,100)+"%";
  percentualMeta.innerText=perc.toFixed(1)+"% da meta";

  listaVendas.innerHTML="";
  dados.vendas.forEach(v=>{
    listaVendas.innerHTML+=`
      <tr>
        <td>${v.data.toLocaleDateString("pt-BR")}</td>
        <td>${moeda(v.valor)}</td>
        <td>${v.perc}%</td>
        <td>${moeda(v.com)}</td>
      </tr>`;
  });

  relatorioAnual.innerHTML="";
  labels.forEach((l,i)=>{
    relatorioAnual.innerHTML+=`<tr><td>${l}</td><td>${moeda(valores[i])}</td></tr>`;
  });

  if(grafico)grafico.destroy();
  grafico=new ApexCharts(document.querySelector("#graficoPrincipal"),{
    chart:{height:350,toolbar:{show:false}},
    series:[
      {name:"Vendas",type:"column",data:valores},
      {name:"Evolu√ß√£o",type:"line",data:valores}
    ],
    xaxis:{categories:labels},
    colors:["#6366f1","#22c55e"]
  });
  grafico.render();
}

atualizarTudo();
</script>
</body>
</html>
