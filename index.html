<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Controle de Vendas</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
  --bg:#0b1020;
  --card:#111827;
  --card2:#1f2937;
  --primary:#6366f1;
  --success:#22c55e;
  --danger:#ef4444;
  --text:#e5e7eb;
  --muted:#9ca3af;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:Segoe UI, Arial;
  background:var(--bg);
  color:var(--text);
}

/* LOGIN */
#login{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}

.login-box{
  background:var(--card);
  padding:30px;
  border-radius:16px;
  width:320px;
  box-shadow:0 20px 40px rgba(0,0,0,.5);
}

.login-box h2{
  text-align:center;
  margin-bottom:20px;
}

.login-box input{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin-bottom:10px;
}

.password-box{
  position:relative;
}

.password-box span{
  position:absolute;
  right:10px;
  top:12px;
  cursor:pointer;
}

.login-box button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:var(--primary);
  color:#fff;
  margin-top:10px;
  cursor:pointer;
}

/* DASHBOARD */
#app{
  display:none;
  padding:20px;
}

.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}

.badge{
  background:var(--card2);
  padding:8px 14px;
  border-radius:20px;
  font-size:14px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:15px;
}

.card{
  background:var(--card);
  padding:20px;
  border-radius:16px;
}

.card h4{
  margin:0;
  color:var(--muted);
}

.card h2{
  margin-top:10px;
}

input,select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin-top:8px;
}

button.action{
  margin-top:10px;
  background:var(--primary);
  color:#fff;
  padding:12px;
  border:none;
  border-radius:10px;
  cursor:pointer;
}

.hidden{display:none}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}

th,td{
  padding:10px;
  border-bottom:1px solid #2a2f3a;
  text-align:center;
}

canvas{
  max-width:100%;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login">
  <div class="login-box">
    <h2>Login</h2>
    <input id="user" placeholder="Usu√°rio">
    <div class="password-box">
      <input id="pass" type="password" placeholder="Senha">
      <span onclick="togglePass()">üëÅ</span>
    </div>
    <button onclick="login()">Entrar</button>
    <button onclick="visitante()" style="background:#374151">Entrar como visitante</button>
  </div>
</div>

<!-- APP -->
<div id="app">
  <div class="header">
    <h1>Controle de Vendas</h1>
    <div class="badge" id="perfil"></div>
  </div>

  <!-- ADMIN -->
  <div id="adminArea">
    <div class="card">
      <h4>Meta do m√™s (R$)</h4>
      <input id="metaInput" placeholder="Ex: 15000">
      <button class="action" onclick="salvarMeta()">Salvar meta</button>
    </div>

    <div class="card">
      <h4>Nova venda</h4>
      <input id="vendaInput" placeholder="Ex: 2090,00">
      <select id="percInput">
        <option value="6">6%</option>
        <option value="5">5%</option>
        <option value="4">4%</option>
        <option value="3">3%</option>
      </select>
      <button class="action" onclick="addVenda()">Adicionar venda</button>
    </div>
  </div>

  <!-- INDICADORES -->
  <div class="grid">
    <div class="card"><h4>Meta</h4><h2 id="meta">R$ 0,00</h2></div>
    <div class="card"><h4>Total vendido</h4><h2 id="total">R$ 0,00</h2></div>
    <div class="card"><h4>Falta para meta</h4><h2 id="falta">R$ 0,00</h2></div>
    <div class="card"><h4>Comiss√£o</h4><h2 id="comissao" style="color:var(--success)">R$ 0,00</h2></div>
  </div>

  <!-- GRAFICO -->
  <div class="card">
    <h4>Gr√°fico mensal</h4>
    <canvas id="grafico"></canvas>
  </div>

  <!-- HISTORICO -->
  <div class="card">
    <h4>Hist√≥rico de vendas</h4>
    <table>
      <thead>
        <tr>
          <th>Data</th>
          <th>Venda</th>
          <th>%</th>
          <th>Comiss√£o</th>
        </tr>
      </thead>
      <tbody id="lista"></tbody>
    </table>
  </div>
</div>

<script>
let dados = JSON.parse(localStorage.getItem("dados")) || {
  meta:0,
  vendas:[]
};
let isAdmin=false;
let chart;

function togglePass(){
  const p=document.getElementById("pass");
  p.type=p.type==="password"?"text":"password";
}

function login(){
  if(user.value==="admin" && pass.value==="admin123"){
    isAdmin=true;
    iniciar();
  }else{
    alert("Login inv√°lido");
  }
}

function visitante(){
  isAdmin=false;
  iniciar();
}

function iniciar(){
  login.style.display="none";
  app.style.display="block";
  perfil.innerText=isAdmin?"Administrador":"Visitante";
  if(!isAdmin) adminArea.style.display="none";
  atualizar();
}

function salvarMeta(){
  dados.meta=Number(metaInput.value.replace(",","."))||0;
  salvar();
}

function addVenda(){
  const valor=Number(vendaInput.value.replace(",","."))||0;
  if(valor<=0) return;
  const p=Number(percInput.value);
  dados.vendas.push({
    data:new Date().toLocaleDateString("pt-BR"),
    valor,
    perc:p,
    com:valor*p/100
  });
  vendaInput.value="";
  salvar();
}

function salvar(){
  localStorage.setItem("dados",JSON.stringify(dados));
  atualizar();
}

function atualizar(){
  meta.innerText="R$ "+dados.meta.toFixed(2);
  let total=0,com=0;
  lista.innerHTML="";
  dados.vendas.forEach(v=>{
    total+=v.valor;
    com+=v.com;
    lista.innerHTML+=`<tr>
      <td>${v.data}</td>
      <td>R$ ${v.valor.toFixed(2)}</td>
      <td>${v.perc}%</td>
      <td>R$ ${v.com.toFixed(2)}</td>
    </tr>`;
  });
  total.innerText="R$ "+total.toFixed(2);
  comissao.innerText="R$ "+com.toFixed(2);
  falta.innerText="R$ "+Math.max(dados.meta-total,0).toFixed(2);
  grafico(total);
}

function grafico(total){
  if(chart) chart.destroy();
  chart=new Chart(document.getElementById("grafico"),{
    type:"bar",
    data:{
      labels:["Meta","Vendido"],
      datasets:[{
        data:[dados.meta,total],
        backgroundColor:["#6366f1","#22c55e"]
      }]
    }
  });
}
</script>
</body>
</html>
